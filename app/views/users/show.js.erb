<% if params[:type].present? %>
      var $list = $('[data-list-id = "<%= current_list.id %>"]');
      var $listUsers = $('#list-users',$list);
      var $collaboration_user = $('#collaboration-users li#<%= @user.id %>',$list);
      var $user = $('[data-user-id = "<%= @user.id %>"]',$list),
          tooltip = $("a.tooltipped", $collaboration_user).data("tooltip"),
          text, $elem;
      if ($collaboration_user.hasClass('active')) {
          $collaboration_user.removeClass('active');
          text = tooltip.replace("Hide", "Show");
          $("a.tooltipped", $collaboration_user).attr("data-tooltip",text);
          $('.tooltipped').tooltip({delay: 50});
          $user.remove();
        } else {
          $collaboration_user.addClass('active');
          text = tooltip.replace("Show", "Hide");

          $("a.tooltipped", $collaboration_user).attr("data-tooltip",text);
          $listUsers.append("<%= j render partial: 'users/list_user', locals:{user: @user, list: current_list } %>");
          $elem = $("#list_user_<%= @user.id %>");

          if ($elem.length > 0){
            myDroppable_task_to_user($elem);
          }
          $('input[id="task_user_id"]',$user).val("<%= @user.id %>");
          $('.tooltipped').tooltip({delay: 50});
          msCollapsible("collapsible");
          $('.edit_task').submitOnCheck();
          deadlineDatepicker($('input.deadline-datepicker'));
          $('input.deadline-datepicker.hidden-datepicker').hover(handlerIn, handlerOut);
       }
<% end %>
