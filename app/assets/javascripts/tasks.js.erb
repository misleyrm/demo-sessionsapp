$(document).on('turbolinks:load',function(){

  $(".input-field label").on('click', function(){
      console.log('input tags');

  })

    deadlineDatepicker();

    // $("i#btn-datepicker").on('click', function(){
    //     console.log($(this).siblings(".hidden-datepicker"));
    //    $(this).siblings(".hidden-datepicker").focus();
    // })
    //
    // $( ".show_blockers ul" ).mouseenter(function(){
    //    console.log("in");
    //     $( this ).css("background-color","red");
    //   })
    //   .mouseleave( function() {
    //     $( this ).css("background-color","white");
    //   })


// $("div.no-permitted > ul.menu-option li > a").attr("disabled", "disabled");
// $("div.permitted > ul.menu-option li > a").removeAttr("disabled");
//
// $(document).on("click", 'ul.menu-option li > a',function(e){
//   console.log("1111");
//
//   if ($(this).parents(".no-permitted").length > 0){
//      event.preventDefault();
//      return false;
//      alert("Sorry, you don't have permission for this action");
//   }
// })



/**** Tag user *****/
var availableTags = [
    "ActionScript",
    "AppleScript",
    "Asp",
    "BASIC",
    "C",
    "C++",
    "Clojure",
    "COBOL",
    "ColdFusion",
    "Erlang",
    "Fortran",
    "Groovy",
    "Haskell",
    "Java",
    "JavaScript",
    "Lisp",
    "Perl",
    "PHP",
    "Python",
    "Ruby",
    "Scala",
    "Scheme"
    ];

function split(val) {
    return val.split(/@\s*/);
}

function extractLast(term) {
    return split(term).pop();
}

$( "#tags" )
    // don't navigate away from the field on tab when selecting an item
    .on( "keydown", function( event ) {
      console.log("keydown")
      if ( event.keyCode === $.ui.keyCode.TAB &&
          $( this ).autocomplete( "instance" ).menu.active ) {
        event.preventDefault();
      }
    })
    .autocomplete({
      minLength: 0,
      source: function( request, response ) {
        // delegate back to autocomplete, but extract the last term
        response( $.ui.autocomplete.filter(
          availableTags, extractLast( request.term ) ) );
      },
      focus: function() {
        // prevent value inserted on focus
        return false;
      },
      select: function( event, ui ) {
        var terms = split( this.value );
        // remove the current input
        terms.pop();
        // add the selected item
        terms.push( ui.item.value );
        // add placeholder to get the comma-and-space at the end
        terms.push( "" );
        this.value = terms.join( ", " );
        return false;
      }
    });




// $(".input-field input#tags")
// // don't navigate away from the field on tab when selecting an item
// .bind("keydown", function(event) {
//   console.log(event.keyCode);
//     if (event.keyCode === $.ui.keyCode.TAB && $(this).data("autocomplete").menu.active) {
//         event.preventDefault();
//     }
// }).autocomplete({
//     minLength: 0,
//     source: function(request, response) {
//         var term = request.term,
//             results = [];
//         console.log(term);
//         if (term.indexOf("@") >= 0) {
//             term = extractLast(request.term);
//             if (term.length > 0) {
//                 results = $.ui.autocomplete.filter(
//                 availableTags, term);
//             } else {
//                 results = ['Start typing...'];
//             }
//         }
//         response(results);
//     },
//     focus: function() {
//         // prevent value inserted on focus
//         return false;
//     },
//     select: function(event, ui) {
//         var terms = split(this.value);
//         // remove the current input
//         terms.pop();
//         // add the selected item
//         terms.push(ui.item.value);
//         // add placeholder to get the comma-and-space at the end
//         terms.push("");
//         this.value = terms.join("");
//         return false;
//     }
// });
/*** end tag user ****/

})
function deadlineDatepicker(){

  $('.menu-option input.deadline-datepicker').each(function(){
    $(this).datepicker({
      altFormat: "D, d MM",
      minDate: 0,
      onClose: function(){
        var date = $(this).datepicker('getDate');
        console.log(date)
        $.ajax({
          complete:function(request){},
          data:'deadline='+ date,
          dataType:'script',
          type:'PATCH',
          url: $(this).siblings("i.material-icons").attr('data-href')
        })
      }
    });
  });


    $("i#btn-datepicker").on('click', function(){
       $(this).siblings(".hidden-datepicker").focus();
    })

    $( ".show_blockers ul" ).mouseenter(function(){
       console.log("in");
        $( this ).css("background-color","red");
      })
      .mouseleave( function() {
        $( this ).css("background-color","white");
      })
}
